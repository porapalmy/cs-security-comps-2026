rule HTML_Malware_Obfuscated_JS {
    meta:
        author = "your_name"
        description = "Detects obfuscated JavaScript in HTML"
        category = "html_malware"

    strings:
        $eval = "eval("
        $atob = "atob("
        $fromCharCode = "String.fromCharCode"
        $base64 = /atob\(["'][A-Za-z0-9+\/]{40,}={0,2}["']\)/

    condition:
        2 of ($eval, $atob, $fromCharCode) or
        ($base64 and filesize < 500KB)
}
